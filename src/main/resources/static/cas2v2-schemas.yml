components:
  schemas:
    NewCas2v2Application:
      type: object
      properties:
        crn:
          type: string
        convictionId:
          type: integer
          format: int64
          example: 1502724704
        deliusEventNumber:
          type: string
          example: "7"
        offenceId:
          type: string
          example: "M1502750438"
        applicationOrigin:
          $ref: "#/components/schemas/ApplicationOrigin"
      required:
        - crn
        - applicationOrigin
    SubmitCas2v2Application:
      type: object
      properties:
        translatedDocument:
          $ref: '_shared.yml#/components/schemas/Unit'
        applicationId:
          type: string
          format: uuid
          description: Id of the application being submitted
        preferredAreas:
          type: string
          description: First and second preferences for where the accommodation should be located, pipe-separated
          example: 'Leeds | Bradford'
        hdcEligibilityDate:
          type: string
          example: '2023-03-30'
          format: date
        conditionalReleaseDate:
          type: string
          example: '2023-04-30'
          format: date
        telephoneNumber:
          type: string
        applicationOrigin:
          $ref: "_shared.yml#/components/schemas/ApplicationOrigin"
        bailHearingDate:
          type: string
          format: date
      required:
        - translatedDocument
        - applicationId
        - telephoneNumber
        - applicationOrigin
    Cas2v2Assessment:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nacroReferralId:
          type: string
        assessorName:
          type: string
        statusUpdates:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/Cas2StatusUpdate'
      required:
        - id
    Cas2v2Application:
      allOf:
        - $ref: '_shared.yml#/components/schemas/Application'
        - type: object
          properties:
            createdBy:
              $ref: '_shared.yml#/components/schemas/NomisUser'
            schemaVersion:
              type: string
              format: uuid
            outdatedSchema:
              type: boolean
            data:
              $ref: '_shared.yml#/components/schemas/Unit'
            document:
              $ref: '_shared.yml#/components/schemas/Unit'
            status:
              $ref: '_shared.yml#/components/schemas/ApplicationStatus'
            submittedAt:
              type: string
              format: date-time
            telephoneNumber:
              type: string
            assessment:
              $ref: '_shared.yml#/components/schemas/Cas2v2Assessment'
            timelineEvents:
              type: array
              items:
                $ref: '_shared.yml#/components/schemas/Cas2TimelineEvent'
            applicationOrigin:
              $ref: "_shared.yml#/components/schemas/ApplicationOrigin"
            bailHearingDate:
              type: string
              format: date
          required:
            - createdBy
            - schemaVersion
            - outdatedSchema
            - status
            - applicationOrigin
    Cas2v2SubmittedApplication:
      type: object
      properties:
        id:
          type: string
          format: uuid
        person:
          $ref: '_shared.yml#/components/schemas/Person'
        createdAt:
          type: string
          format: date-time
        submittedBy:
          $ref: '_shared.yml#/components/schemas/NomisUser'
        schemaVersion:
          type: string
          format: uuid
        outdatedSchema:
          type: boolean
        document:
          $ref: '_shared.yml#/components/schemas/Unit'
        submittedAt:
          type: string
          format: date-time
        telephoneNumber:
          type: string
        timelineEvents:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/Cas2TimelineEvent'
        assessment:
          type: object
          $ref: '_shared.yml#/components/schemas/Cas2v2Assessment'
        applicationOrigin:
            $ref: "_shared.yml#/components/schemas/ApplicationOrigin"
        bailHearingDate:
          type: string
          format: date
      required:
        - id
        - person
        - createdAt
        - createdBy
        - schemaVersion
        - outdatedSchema
        - status
        - timelineEvents
        - assessment
    Cas2v2ApplicationSummary:
      type: object
      properties:
        type:
          type: string
        id:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        submittedAt:
          type: string
          format: date-time
        createdByUserId:
          type: string
          format: uuid
        createdByUserName:
          type: string
        status:
          $ref: '_shared.yml#/components/schemas/ApplicationStatus'
        latestStatusUpdate:
          $ref: '_shared.yml#/components/schemas/LatestCas2StatusUpdate'
        risks:
          $ref: '_shared.yml#/components/schemas/PersonRisks'
        hdcEligibilityDate:
          type: string
          format: date
        personName:
          type: string
        crn:
          type: string
        nomsNumber:
          type: string
        applicationOrigin:
          $ref: "_shared.yml#/components/schemas/ApplicationOrigin"
        bailHearingDate:
          type: string
          format: date
      required:
        - type
        - id
        - createdAt
        - createdByUserId
        - status
        - personName
        - crn
        - nomsNumber
        - applicationOrigin
    Cas2v2SubmittedApplicationSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        createdByUserId:
          type: string
          format: uuid
        crn:
          type: string
        nomsNumber:
          type: string
        personName:
          type: string
        createdAt:
          type: string
          format: date-time
        submittedAt:
          type: string
          format: date-time
        applicationOrigin:
          $ref: "_shared.yml#/components/schemas/ApplicationOrigin"
        bailHearingDate:
          type: string
          format: date
      required:
        - createdByUserId
        - status
        - id
        - person
        - createdAt
        - personName
        - crn
        - nomsNumber
    Cas2v2ApplicationNote:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          example: 'roger@example.com'
        name:
          type: string
          example: 'Roger Smith'
        body:
          type: string
        createdAt:
          type: string
          format: date-time
      required:
        - username
        - email
        - name
        - body
        - createdAt
      description: Notes added to a Cas2v2Application
    ApplicationOrigin:
      type: string
      default: homeDetentionCurfew
      enum:
        - courtBail
        - prisonBail
        - homeDetentionCurfew