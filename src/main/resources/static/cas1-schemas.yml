components:
  schemas:
    Cas1PremisesBasicSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: Hope House
        apCode:
          type: string
          example: NEHOPE1
        apArea:
          $ref: '_shared.yml#/components/schemas/NamedId'
        bedCount:
          type: integer
          example: 22
        supportsSpaceBookings:
          type: boolean
      required:
        - id
        - name
        - apArea
        - bedCount
        - supportsSpaceBookings
    Cas1PremisesSearchResultSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        apCode:
          type: string
          example: NEHOPE1
        deliusQCode:
          type: string
          example: Q005
        apType:
          $ref: '_shared.yml#/components/schemas/ApType'
        name:
          type: string
          example: Hope House
        addressLine1:
          type: string
          example: 1 The Street
        addressLine2:
          type: string
          example: Blackmore End
        town:
          type: string
          example: Braintree
        postcode:
          type: string
          example: LS1 3AD
        apArea:
          $ref: '_shared.yml#/components/schemas/NamedId'
        totalSpaceCount:
          type: integer
          description: The total number of spaces in this premises
          example: 22
        premisesCharacteristics:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/CharacteristicPair'
    Cas1PremisesSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: Hope House
        apCode:
          type: string
          example: NEHOPE1
        postcode:
          type: string
          example: LS1 3AD
        apArea:
          $ref: '_shared.yml#/components/schemas/ApArea'
        bedCount:
          type: integer
          description: The total number of beds in this premises
          example: 22
        availableBeds:
          type: integer
          description: The total number of beds available at this moment in time
          example: 20
        outOfServiceBeds:
          type: integer
          description: The total number of out of service beds at this moment in time
          example: 2
        supportsSpaceBookings:
          type: boolean
      required:
        - id
        - name
        - apCode
        - postcode
        - apArea
        - bedCount
        - availableBeds
        - outOfServiceBeds
        - supportsSpaceBookings
    Cas1SpaceCharacteristic:
      type: string
      description: All of the characteristics of both premises and rooms
      enum:
        - acceptsChildSexOffenders
        - acceptsHateCrimeOffenders
        - acceptsNonSexualChildOffenders
        - acceptsSexOffenders
        - hasArsonInsuranceConditions
        - hasBrailleSignage
        - hasCallForAssistance
        - hasCrib7Bedding
        - hasEnSuite
        - hasFixedMobilityAids
        - hasHearingLoop
        - hasLift
        - hasNearbySprinkler
        - hasSmokeDetector
        - hasStepFreeAccess
        - hasStepFreeAccessToCommunalAreas
        - hasTactileFlooring
        - hasTurningSpace
        - hasWheelChairAccessibleBathrooms
        - hasWideAccessToCommunalAreas
        - hasWideDoor
        - hasWideStepFreeAccess
        - isArsonDesignated
        - isArsonSuitable
        - isCatered
        - isFullyFm
        - isGroundFloor
        - isGroundFloorNrOffice
        - isIAP
        - isSingle
        - isStepFreeDesignated
        - isSuitableForVulnerable
        - isSuitedForSexOffenders
        - isTopFloorVulnerable
        - isWheelchairAccessible
        - isWheelchairDesignated
    NewCas1SpaceBooking:
      type: object
      properties:
        arrivalDate:
          type: string
          format: date
          example: 2022-07-28
        departureDate:
          type: string
          format: date
          example: 2022-09-30
        premisesId:
          type: string
          format: uuid
          example: 290fa58c-77b2-47e2-b729-4cd6b2ed1a78
        requirements:
          type: object
          $ref: '#/components/schemas/Cas1SpaceBookingRequirements'
      required:
        - arrivalDate
        - departureDate
        - premisesId
        - requirements
    Cas1SpaceBookingRequirements:
      type: object
      properties:
        essentialCharacteristics:
          type: array
          items:
            $ref: '#/components/schemas/Cas1SpaceCharacteristic'
      required:
        - essentialCharacteristics
    Cas1SpaceSearchRequirements:
      type: object
      properties:
        apTypes:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/ApType'
        spaceCharacteristics:
          type: array
          items:
            $ref: '#/components/schemas/Cas1SpaceCharacteristic'
        genders:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/Gender'
      required:
        - apType
        - gender
    Cas1SpaceSearchParameters:
      type: object
      properties:
        startDate:
          type: string
          format: date
          description: The date the space is required from
        durationInDays:
          type: integer
          example: 84
          description: The number of days the space is needed, from the start date
        targetPostcodeDistrict:
          type: string
          description: The 'target' location, in the form of a postcode district
          example: SE5
        requirements:
          $ref: '#/components/schemas/Cas1SpaceSearchRequirements'
      required:
        - startDate
        - durationInDays
        - targetPostcodeDistrict
        - requirements
    Cas1SpaceSearchResults:
      type: object
      properties:
        searchCriteria:
          $ref: '#/components/schemas/Cas1SpaceSearchParameters'
        resultsCount:
          type: integer
          example: 4
        results:
          type: array
          items:
            $ref: '#/components/schemas/Cas1SpaceSearchResult'
      required:
        - resultsCount
        - results
    Cas1SpaceSearchResult:
      type: object
      properties:
        premises:
          $ref: '#/components/schemas/Cas1PremisesSearchResultSummary'
        distanceInMiles:
          type: number
          example: 2.1
        spacesAvailable:
          type: array
          items:
            $ref: '#/components/schemas/Cas1SpaceAvailability'
    Cas1SpaceAvailability:
      type: object
      properties:
        spaceCharacteristics:
          type: array
          items:
            $ref: '#/components/schemas/Cas1SpaceCharacteristic'
        durationInDays:
          type: integer
          example: 77
    Cas1SpaceCategory:
      type: string
      example: arson
      description: Spaces are categorised by these traits - 'standard' plus selected physcial and risk characteristics
      enum:
        - standard
        - arson
        - wheelchair
        - sexOffender
        - enSuite
        - single
    Cas1SpaceBooking:
      type: object
      properties:
        id:
          type: string
          format: uuid
        applicationId:
          type: string
          format: uuid
        assessmentId:
          type: string
          format: uuid
        person:
          $ref: '_shared.yml#/components/schemas/Person'
        tier:
          type: string
        requirements:
          $ref: '#/components/schemas/Cas1SpaceBookingRequirements'
        premises:
          $ref: '_shared.yml#/components/schemas/NamedId'
        apArea:
          $ref: '_shared.yml#/components/schemas/NamedId'
        bookedBy:
          $ref: '_shared.yml#/components/schemas/User'
        requestForPlacementId:
          type: string
          format: uuid
        expectedArrivalDate:
          type: string
          format: date
        expectedDepartureDate:
          type: string
          format: date
        actualArrivalDate:
          type: string
          format: date-time
        actualDepartureDate:
          type: string
          format: date-time
        canonicalArrivalDate:
          description: actual arrival date or, if not known, the expected arrival date
          type: string
          format: date
        canonicalDepartureDate:
          description: actual departure date or, if not known, the expected departure date
          type: string
          format: date
        departure:
          $ref: '#/components/schemas/Cas1SpaceBookingDeparture'
        createdAt:
          type: string
          format: date-time
        keyWorkerAllocation:
          $ref: '#/components/schemas/Cas1KeyWorkerAllocation'
        otherBookingsInPremisesForCrn:
          type: array
          items:
            $ref: '#/components/schemas/Cas1SpaceBookingDates'
        cancellation:
          $ref: '#/components/schemas/Cas1SpaceBookingCancellation'
        nonArrival:
          $ref: '#/components/schemas/Cas1SpaceBookingNonArrival'
        deliusEventNumber:
          type: string
      required:
        - id
        - applicationId
        - person
        - requirements
        - premises
        - apArea
        - expectedArrivalDate
        - expectedDepartureDate
        - canonicalArrivalDate
        - canonicalDepartureDate
        - createdAt
        - otherBookingsInPremisesForCrn
    Cas1SpaceBookingDates:
      type: object
      properties:
        id:
          type: string
          format: uuid
        canonicalArrivalDate:
          description: actual arrival date or, if not known, the expected arrival date
          type: string
          format: date
        canonicalDepartureDate:
          description: actual departure date or, if not known, the expected departure date
          type: string
          format: date
      required:
        - id
        - canonicalArrivalDate
        - canonicalDepartureDate
    Cas1SpaceBookingSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        person:
          $ref: "_shared.yml#/components/schemas/PersonSummary"
        canonicalArrivalDate:
          description: actual arrival date or, if not known, the expected arrival date
          type: string
          format: date
        canonicalDepartureDate:
          description: actual departure date or, if not known, the expected departure date
          type: string
          format: date
        tier:
          description: Risk rating tier level of corresponding application
          type: string
        keyWorkerAllocation:
          $ref: '#/components/schemas/Cas1KeyWorkerAllocation'
        status:
          $ref: '#/components/schemas/Cas1SpaceBookingSummaryStatus'
      required:
        - id
        - person
        - canonicalArrivalDate
        - canonicalDepartureDate
    Cas1SpaceBookingSummarySortField:
      type: string
      enum:
        - personName
        - canonicalArrivalDate
        - canonicalDepartureDate
        - keyWorkerName
        - tier
    Cas1SpaceBookingSummaryStatus:
      type: string
      enum:
        - arrivingWithin6Weeks
        - arrivingWithin2Weeks
        - arrivingToday
        - overdueArrival
        - arrived
        - notArrived
        - departingWithin2Weeks
        - departingToday
        - overdueDeparture
        - departed
    Cas1SpaceBookingResidency:
      type: string
      enum:
        - upcoming
        - current
        - historic
    Cas1KeyWorkerAllocation:
      type: object
      properties:
        keyWorker:
          $ref: '_shared.yml#/components/schemas/StaffMember'
        allocatedAt:
          type: string
          format: date
      required:
        - keyWorker
        - allocatedAt
    Cas1SpaceBookingDeparture:
      type: object
      properties:
        reason:
          $ref: '_shared.yml#/components/schemas/NamedId'
        parentReason:
          $ref: '_shared.yml#/components/schemas/NamedId'
        moveOnCategory:
          $ref: '_shared.yml#/components/schemas/NamedId'
        notes:
          type: string
      required:
        - reason
    Cas1SpaceBookingCancellation:
      type: object
      properties:
        occurredAt:
          type: string
          format: date
        recordedAt:
          type: string
          format: date-time
        reason:
          $ref: '_shared.yml#/components/schemas/CancellationReason'
        reason_notes:
          type: string
      required:
        - occurredAt
        - recordedAt
        - reason
    Cas1SpaceBookingNonArrival:
      type: object
      properties:
        confirmedAt:
          type: string
          format: date-time
        reason:
          $ref: '_shared.yml#/components/schemas/NamedId'
        notes:
          type: string
    Cas1NewArrival:
      type: object
      properties:
        arrivalDateTime:
          description: This is deprecated. Instead use arrivalDate and arrivalTime
          deprecated: true
          type: string
          format: date-time
        arrivalDate:
          type: string
          format: date
        arrivalTime:
          type: string
          pattern: '^([01][0-9]|2[0-3]):([0-5][0-9])$'
          example: '23:15'
    Cas1NonArrival:
      type: object
      properties:
        reason:
          type: string
          format: uuid
        notes:
          type: string
      required:
        - reason
    Cas1NewDeparture:
      type: object
      properties:
        departureDateTime:
          type: string
          format: date-time
        departureDate:
          type: string
          format: date
        departureTime:
          type: string
          pattern: '^([01][0-9]|2[0-3]):([0-5][0-9])$'
          example: '23:15'
        reasonId:
          type: string
          format: uuid
        moveOnCategoryId:
          type: string
          format: uuid
        notes:
          type: string
      required:
        - reasonId
    Cas1AssignKeyWorker:
      type: object
      properties:
        staffCode:
          type: string
      required:
        - staffCode
    Cas1ApprovedPremisesGender:
      type: string
      enum:
        - man
        - woman
    Cas1UpdateUser:
      type: object
      properties:
        roles:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/ApprovedPremisesUserRole'
        qualifications:
          type: array
          items:
            $ref: '_shared.yml#/components/schemas/UserQualification'
        cruManagementAreaOverrideId:
          type: string
          format: uuid
      required:
        - roles
        - qualifications
    NewCas1SpaceBookingCancellation:
      type: object
      properties:
        occurredAt:
          type: string
          format: date
        reasonId:
          type: string
          format: uuid
        reasonNotes:
          type: string
      required:
        - occurredAt
        - reasonId
    Cas1PremiseCapacity:
      type: object
      properties:
        premise:
          $ref: '#/components/schemas/Cas1PremisesSummary'
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        capacity:
          type: array
          items:
            $ref: '#/components/schemas/Cas1PremiseCapacityForDay'
      required:
        - premise
        - startDate
        - endDate
        - capacity
    Cas1PremiseCapacityForDay:
      type: object
      properties:
        totalBedCount:
          description: total bed count including temporarily unavailable beds (e.g. out of service beds)
          type: integer
        availableBedCount:
          description: total bed count excluding temporarily unavailable beds (e.g. out of service beds)
          type: integer
        bookingCount:
          type: integer
        characteristicAvailability:
          type: array
          items:
            $ref: '#/components/schemas/Cas1PremiseCharacteristicAvailability'
      required:
        - totalBedCount
        - availableBedCount
        - bookingCount
        - characteristicAvailability
    Cas1PremiseCharacteristicAvailability:
      type: object
      description:  "Will only ever be returned for the following characteristics: 'isArsonSuitable', 'hasEnSuite', 'isSingle', 'isStepFreeDesignated', 'isSuitedForSexOffenders' or 'isWheelchairDesignated'"
      properties:
        characteristic:
          $ref: '#/components/schemas/Cas1SpaceCharacteristic'
        availableBedsCount:
          description: the number of available beds with this characteristic
          type: integer
        bookingsCount:
          description: the number of bookings requiring this characteristic
          type: integer
      required:
        - characteristic
        - availableBedsCount
        - bookingsCount
    Cas1ReportName:
      type: string
      enum:
        - applications
        - applicationsV2
        - dailyMetrics
        - lostBeds
        - outOfServiceBeds
        - placementApplications
        - placementMatchingOutcomes
        - placementMatchingOutcomesV2
        - requestsForPlacement
    Cas1OutOfServiceBed:
      type: object
      properties:
        id:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        bed:
          $ref: '_shared.yml#/components/schemas/NamedId'
        room:
          $ref: '_shared.yml#/components/schemas/NamedId'
        premises:
          $ref: '_shared.yml#/components/schemas/NamedId'
        apArea:
          $ref: '_shared.yml#/components/schemas/NamedId'
        reason:
          $ref: '#/components/schemas/Cas1OutOfServiceBedReason'
        referenceNumber:
          type: string
        notes:
          type: string
        daysLostCount:
          type: integer
        temporality:
          $ref: '_shared.yml#/components/schemas/Temporality'
        status:
          $ref: '#/components/schemas/Cas1OutOfServiceBedStatus'
        cancellation:
          nullable: true
          allOf:
            - $ref: '#/components/schemas/Cas1OutOfServiceBedCancellation'
        revisionHistory:
          type: array
          items:
            $ref: '#/components/schemas/Cas1OutOfServiceBedRevision'
      required:
        - id
        - createdAt
        - startDate
        - endDate
        - bed
        - room
        - premises
        - apArea
        - reason
        - daysLostCount
        - temporality
        - status
        - revisionHistory
    NewCas1OutOfServiceBed:
      type: object
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        reason:
          type: string
          format: uuid
        referenceNumber:
          type: string
        notes:
          type: string
        bedId:
          type: string
          format: uuid
      required:
        - startDate
        - endDate
        - reason
        - bedId
    UpdateCas1OutOfServiceBed:
      type: object
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        reason:
          type: string
          format: uuid
        referenceNumber:
          type: string
        notes:
          type: string
      required:
        - startDate
        - endDate
        - reason
    Cas1OutOfServiceBedCancellation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        notes:
          type: string
      required:
        - id
        - createdAt
    NewCas1OutOfServiceBedCancellation:
      type: object
      properties:
        notes:
          type: string
    Cas1OutOfServiceBedStatus:
      type: string
      enum:
        - active
        - cancelled
    Cas1OutOfServiceBedReason:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: Double Room with Single Occupancy - Other (Non-FM)
        isActive:
          type: boolean
      required:
        - id
        - name
        - isActive
    Cas1OutOfServiceBedSortField:
      type: string
      enum:
        - premisesName
        - roomName
        - bedName
        - startDate
        - endDate
        - reason
        - daysLost
    Cas1OutOfServiceBedRevision:
      type: object
      properties:
        id:
          type: string
          format: uuid
        updatedAt:
          type: string
          format: date-time
        updatedBy:
          $ref: '_shared.yml#/components/schemas/User'
        revisionType:
          type: array
          items:
            $ref: '#/components/schemas/Cas1OutOfServiceBedRevisionType'
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        reason:
          $ref: '#/components/schemas/Cas1OutOfServiceBedReason'
        referenceNumber:
          type: string
        notes:
          type: string
      required:
        - id
        - updatedAt
        - revisionType
    Cas1OutOfServiceBedRevisionType:
      type: string
      enum:
        - created
        - updatedStartDate
        - updatedEndDate
        - updatedReferenceNumber
        - updatedReason
        - updatedNotes